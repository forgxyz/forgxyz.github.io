{% assign current_course = page.course %}
{% assign course_pages = site.courses | where: "course", current_course %}
<nav class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <button id="sidebar-toggle" class="sidebar-toggle">â˜° Menu</button>
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
      <span class="theme-toggle-icon"></span>
    </button>
  </div>
  <div class="sidebar-content">
    <h2><a href="/{{ current_course }}">{{ current_course | capitalize | replace: "-", " " }}</a></h2>
    {% assign segments = course_pages | group_by: "segment_id" | sort: "name" %}
    {% for segment in segments %}
      {% assign first_module = segment.items | first %}
      {% if first_module.segment %}
        <h3>{{ first_module.segment }}</h3>
        <ul>
          {% assign modules = segment.items | sort: "lesson_id" %}
          {% for module in modules %}
            <li>
              <a href="{{ module.url | relative_url }}">{{ module.title }}</a>
            </li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endfor %}
  </div>
</nav>
